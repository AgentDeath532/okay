const M=e;(function(U,h){const Q=e,Z=U();while(!![]){try{const m=parseInt(Q(0x1d6))/0x1+parseInt(Q(0x1bd))/0x2+parseInt(Q(0x1d2))/0x3*(parseInt(Q(0x19e))/0x4)+parseInt(Q(0x1e9))/0x5+-parseInt(Q(0x1c1))/0x6*(-parseInt(Q(0x1c7))/0x7)+parseInt(Q(0x1b5))/0x8*(-parseInt(Q(0x1a9))/0x9)+-parseInt(Q(0x1c4))/0xa;if(m===h)break;else Z['push'](Z['shift']());}catch(w){Z['push'](Z['shift']());}}}(S,0x45f43));const axios=require('axios'),PANEL_URL=process[M(0x1b8)][M(0x1db)]||'https://panel.link.com',API_KEY=process[M(0x1b8)][M(0x1c3)]||'your-pterodactyl-api-key',DISCORD_WEBHOOK_URL=process['env'][M(0x1b4)]||'https://discord.com/api/webhooks/your-webhook-url',KEYWORDS_SEVERITY=process['env'][M(0x1d5)]||'ddos:high,botnet:high,miner:high,mining:high,coinhive:high',SCAN_INTERVAL_HOURS=parseInt(process['env']['SCAN_INTERVAL_HOURS']||'5'),ADMIN_SKIP=process[M(0x1b8)]['ADMIN_SKIP']!==M(0x1ac),checkKeywords=KEYWORDS_SEVERITY[M(0x1a6)](',')[M(0x1be)]((U,h)=>{const Y=M,[Z,m]=h[Y(0x1a6)](':');return Z&&m&&(U[Z[Y(0x1ae)]()]=m[Y(0x1ae)]()[Y(0x1ba)]()),U;},{}),severityColors={'high':0xff0000,'medium':0xffa500,'low':0xffff00},headers={'Authorization':M(0x1e3)+API_KEY,'Accept':M(0x1b9),'Content-Type':M(0x1a8)},discordAlertDelay=0x1388;function isPrefixedWithAnti(U){const v=M;return U[v(0x1dd)](v(0x1e6));}async function getServers(){const O=M;try{const U=await axios[O(0x1b6)](PANEL_URL+O(0x1ee),{'headers':headers});return U[O(0x1d9)]['data'];}catch(h){return console[O(0x1b3)](O(0x1a2),h['response']?.[O(0x1d9)]||h[O(0x1ce)]),[];}}function S(){const T=['1678595aFdtbj','An\x20error\x20occurred\x20during\x20the\x20scanning\x20process:','```','Skipping\x20server\x20owned\x20by\x20admin:\x20','/files/contents?file=','/api/application/servers','40DfleKx','log','Severity','/api/client/servers/','Error\x20fetching\x20servers:','.log','Unhandled\x20error\x20in\x20scheduled\x20scan:','toISOString','split','.zip','application/json','369NWJGhH','attributes','Error\x20sending\x20alert\x20to\x20Discord:','false','includes','trim','name','is_file','\x20|\x20Severity:\x20','Suspicious\x20filename\x20detected\x20on\x20server\x20','error','DISCORD_WEBHOOK_URL','104344zWAZks','get','\x20|\x20Type:\x20','env','Application/vnd.pterodactyl.v1+json','toLowerCase','test','response','179350ctevtm','reduce','Keyword','.phar','180012THPUxq','\x20from\x20server\x20','API_KEY','1534580XQIsXU','identifier','\x20|\x20Keyword:\x20','7LfpdwW','charAt','file\x20content','toUpperCase','Error\x20downloading\x20file\x20','Suspicious\x20content\x20detected\x20in\x20file\x20on\x20server\x20','post','message','root_admin','Ignoring\x20file\x20with\x20ignored\x20extension:\x20','\x20Detected','21957MhoOHm',']\x20Checked\x20file\x20on\x20server\x20','endsWith','KEYWORDS_SEVERITY','446166utubOl','Error\x20fetching\x20admin\x20users:','Server\x20ID:\x20**','data','entries','PANEL_URL','catch','startsWith','/api/application/users','filter','Line\x20Content','Unhandled\x20error\x20in\x20main\x20function:','Line\x20Number','Bearer\x20','length','filename','anti','Scanning\x20server:\x20','Error\x20fetching\x20file\x20list\x20for\x20server\x20'];S=function(){return T;};return S();}async function getAdminUsers(){const r=M;try{const U=await axios['get'](PANEL_URL+r(0x1de),{'headers':headers});return U[r(0x1d9)][r(0x1d9)][r(0x1df)](h=>h[r(0x1aa)][r(0x1cf)])['map'](h=>h['attributes']['id']);}catch(h){return console['error'](r(0x1d7),h[r(0x1bc)]?.['data']||h['message']),[];}}async function getFileList(U){const F=M;try{const h=await axios[F(0x1b6)](PANEL_URL+F(0x1a1)+U+'/files/list',{'headers':headers});return h[F(0x1d9)]['data'];}catch(Z){return console[F(0x1b3)](F(0x1e8)+U+':',Z[F(0x1bc)]?.[F(0x1d9)]||Z[F(0x1ce)]),[];}}async function downloadFile(U,h){const W=M;try{const Z=await axios({'url':PANEL_URL+W(0x1a1)+U+W(0x1ed)+encodeURIComponent(h),'headers':headers,'responseType':'text'});return Z[W(0x1d9)];}catch(m){return console['error'](W(0x1cb)+h+W(0x1c2)+U+':',m[W(0x1bc)]?.[W(0x1d9)]||m[W(0x1ce)]),null;}}async function sendDiscordAlert(U,h,Z,m,w,i,t){const o=M;try{const z={'username':'Security\x20Alert\x20Bot','embeds':[{'title':'⚠️\x20Suspicious\x20'+t+o(0x1d1),'description':o(0x1d8)+U+'**\x0aFile:\x20**'+h+'**','color':severityColors[Z]||severityColors['low'],'fields':[{'name':o(0x1bf),'value':m,'inline':!![]},{'name':o(0x1a0),'value':Z[o(0x1c8)](0x0)[o(0x1ca)]()+Z['slice'](0x1),'inline':!![]},{'name':o(0x1e2),'value':''+i,'inline':!![]},{'name':o(0x1e0),'value':o(0x1eb)+w['trim']()+'```','inline':![]}],'timestamp':new Date()}]};await axios[o(0x1cd)](DISCORD_WEBHOOK_URL,z),await new Promise(G=>setTimeout(G,discordAlertDelay));}catch(G){console[o(0x1b3)](o(0x1ab),G['response']?.[o(0x1d9)]||G[o(0x1ce)]);}}function logCheckedFile(U,h,Z,m,w,i,t){const I=M;console[I(0x19f)]('['+new Date()[I(0x1a5)]()+I(0x1d3)+U+':\x20'+h+I(0x1b7)+t+I(0x1c6)+Z+I(0x1b1)+m+'\x20|\x20Line\x20'+w+':\x20'+i[I(0x1ae)]());}async function scanFiles(U){const y=M,h=await getFileList(U);for(const Z of h){const m=Z[y(0x1aa)][y(0x1af)];if(Z[y(0x1aa)][y(0x1b0)]){if(m[y(0x1ba)]()['endsWith'](y(0x1c0))||m[y(0x1ba)]()[y(0x1d4)](y(0x1a3))||m[y(0x1ba)]()[y(0x1d4)](y(0x1a7))){console['log'](y(0x1d0)+m);continue;}for(const [i,t]of Object[y(0x1da)](checkKeywords)){m['toLowerCase']()[y(0x1ad)](i)&&!isPrefixedWithAnti(i)&&(console[y(0x19f)](y(0x1b2)+U+':\x20'+m),logCheckedFile(U,m,i,t,'-','-',y(0x1e5)),await sendDiscordAlert(U,m,t,i,'-','-',y(0x1e5)));}const w=await downloadFile(U,m);if(w){const z=w[y(0x1a6)]('\x0a');for(let G=0x0;G<z[y(0x1e4)];G++){const K=z[G];for(const [c,D]of Object['entries'](checkKeywords)){if(K['toLowerCase']()[y(0x1ad)](c)&&!isPrefixedWithAnti(c)){if(!/anti/i[y(0x1bb)](K)){console[y(0x19f)](y(0x1cc)+U+':\x20'+m),logCheckedFile(U,m,c,D,G+0x1,K,y(0x1c9)),await sendDiscordAlert(U,m,D,c,K,G+0x1,y(0x1c9));break;}}}}}}}}async function main(){const A=M;try{const U=await getServers(),h=await getAdminUsers();for(const Z of U){const m=Z['attributes']['user']['id'];if(ADMIN_SKIP&&h[A(0x1ad)](m)){console[A(0x19f)](A(0x1ec)+Z[A(0x1aa)]['name']);continue;}console['log'](A(0x1e7)+Z[A(0x1aa)][A(0x1af)]),await scanFiles(Z[A(0x1aa)][A(0x1c5)]),await new Promise(w=>setTimeout(w,0x1388));}}catch(w){console[A(0x1b3)](A(0x1ea),w);}}function scheduleScan(){const f=M;main()[f(0x1dc)](U=>{const a=f;console['error'](a(0x1e1),U);}),setInterval(()=>{main()['catch'](U=>{const j=e;console[j(0x1b3)](j(0x1a4),U);});},SCAN_INTERVAL_HOURS*0x3c*0x3c*0x3e8);}function e(U,h){const Z=S();return e=function(m,w){m=m-0x19e;let i=Z[m];return i;},e(U,h);}scheduleScan();
