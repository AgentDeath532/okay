const _0x578e43=_0x448c;(function(_0x26aa18,_0x2359a4){const _0x450714=_0x448c,_0x1e7a3c=_0x26aa18();while(!![]){try{const _0x42fb0e=-parseInt(_0x450714(0x151))/0x1*(-parseInt(_0x450714(0x158))/0x2)+-parseInt(_0x450714(0x113))/0x3+parseInt(_0x450714(0x17c))/0x4*(parseInt(_0x450714(0x121))/0x5)+-parseInt(_0x450714(0x14a))/0x6*(-parseInt(_0x450714(0x12d))/0x7)+parseInt(_0x450714(0x163))/0x8+parseInt(_0x450714(0x15b))/0x9*(parseInt(_0x450714(0x137))/0xa)+-parseInt(_0x450714(0x115))/0xb;if(_0x42fb0e===_0x2359a4)break;else _0x1e7a3c['push'](_0x1e7a3c['shift']());}catch(_0x5e41b2){_0x1e7a3c['push'](_0x1e7a3c['shift']());}}}(_0xf891,0x2624f));const axios=require('axios'),serverListCache=_0x578e43(0x165),serverIdCache=_0x578e43(0x135),errorLogCache=_0x578e43(0x16c);function processServerData(){const _0xab7bb=(function(){let _0x2fbdcd=!![];return function(_0x441d2b,_0x53b120){const _0x40162e=_0x2fbdcd?function(){const _0x5cd572=_0x448c;if(_0x53b120){const _0x1744ff=_0x53b120[_0x5cd572(0x129)](_0x441d2b,arguments);return _0x53b120=null,_0x1744ff;}}:function(){};return _0x2fbdcd=![],_0x40162e;};}()),_0xcad53f=_0xab7bb(this,function(){const _0x1f7e9c=_0x448c;return _0xcad53f['toString']()['search'](_0x1f7e9c(0x168))[_0x1f7e9c(0x136)]()[_0x1f7e9c(0x12a)](_0xcad53f)[_0x1f7e9c(0x134)](_0x1f7e9c(0x168));});_0xcad53f();const _0x40b3a0=(function(){let _0x380cfc=!![];return function(_0x593429,_0x2fb0f3){const _0x5cca30=_0x380cfc?function(){const _0x4412c5=_0x448c;if(_0x2fb0f3){const _0x4c7391=_0x2fb0f3[_0x4412c5(0x129)](_0x593429,arguments);return _0x2fb0f3=null,_0x4c7391;}}:function(){};return _0x380cfc=![],_0x5cca30;};}()),_0xf918fe=_0x40b3a0(this,function(){const _0x2f2171=_0x448c,_0x11a1ba=function(){const _0x3cf35c=_0x448c;let _0x4c17ae;try{_0x4c17ae=Function('return\x20(function()\x20'+_0x3cf35c(0x116)+');')();}catch(_0x3e8ad5){_0x4c17ae=window;}return _0x4c17ae;},_0x181b02=_0x11a1ba(),_0x140337=_0x181b02[_0x2f2171(0x14e)]=_0x181b02['console']||{},_0x1d7cc5=['log',_0x2f2171(0x147),_0x2f2171(0x13a),'error',_0x2f2171(0x166),_0x2f2171(0x17a),_0x2f2171(0x172)];for(let _0x29b707=0x0;_0x29b707<_0x1d7cc5[_0x2f2171(0x161)];_0x29b707++){const _0xd913e0=_0x40b3a0['constructor'][_0x2f2171(0x108)][_0x2f2171(0x11c)](_0x40b3a0),_0x2416a5=_0x1d7cc5[_0x29b707],_0x181d09=_0x140337[_0x2416a5]||_0xd913e0;_0xd913e0[_0x2f2171(0x160)]=_0x40b3a0['bind'](_0x40b3a0),_0xd913e0['toString']=_0x181d09[_0x2f2171(0x136)][_0x2f2171(0x11c)](_0x181d09),_0x140337[_0x2416a5]=_0xd913e0;}});_0xf918fe();}function processFileData(){const _0x38d2c9=_0x578e43;let _0xb18dfe=[0x1,0x2,0x3,0x4,0x5];return _0xb18dfe=_0xb18dfe[_0x38d2c9(0x109)](_0x109ca9=>_0x109ca9*0x2),_0xb18dfe;}function unnecessaryDataProcessorForServerFiles(){return'This\x20function\x20does\x20nothing\x20but\x20add\x20to\x20code\x20size!';}const PANEL_URL=process['env']['PANEL_URL']||_0x578e43(0x157),API_KEY=process[_0x578e43(0x15f)][_0x578e43(0x177)]||_0x578e43(0x143),DISCORD_WEBHOOK_URL=process[_0x578e43(0x15f)][_0x578e43(0x14c)]||'https://discord.com/api/webhooks/your-webhook-url',KEYWORDS_SEVERITY=process[_0x578e43(0x15f)][_0x578e43(0x119)]||'ddos:high,botnet:high,miner:high,mining:high,coinhive:high',SCAN_INTERVAL_HOURS=parseInt(process[_0x578e43(0x15f)][_0x578e43(0x175)]||'5'),ADMIN_SKIP=process['env']['ADMIN_SKIP']!=='false',tempFunctionCall=processServerData(),keywordSeverityMap=KEYWORDS_SEVERITY[_0x578e43(0x15a)](',')['reduce']((_0x13d175,_0x1c04cd)=>{const _0x2a4f42=_0x578e43,[_0x1e42f5,_0x44e020]=_0x1c04cd[_0x2a4f42(0x15a)](':');return _0x1e42f5&&_0x44e020&&(_0x13d175[_0x1e42f5[_0x2a4f42(0x112)]()]=_0x44e020[_0x2a4f42(0x112)]()[_0x2a4f42(0x11f)]()),_0x13d175;},{});function callProcessFileData(){let _0x5536bf=processFileData();}callProcessFileData();const severityColorMap={'high':0xff0000,'medium':0xffa500,'low':0xffff00},unutilizedVar1='temporaryUnusedString1',unutilizedVar2='temporaryUnusedString2',apiRequestHeaders={'Authorization':'Bearer\x20'+API_KEY,'Accept':'Application/vnd.pterodactyl.v1+json','Content-Type':_0x578e43(0x10e)},discordNotificationDelay=0x1388;function _0x448c(_0x3ad3d1,_0x41532c){const _0x1b7d64=_0xf891();return _0x448c=function(_0x9e2cdc,_0x4d521e){_0x9e2cdc=_0x9e2cdc-0x106;let _0x57f12e=_0x1b7d64[_0x9e2cdc];return _0x57f12e;},_0x448c(_0x3ad3d1,_0x41532c);}function hasAntiPrefix(_0x4be554){const _0x5d614c=_0x578e43;return _0x4be554[_0x5d614c(0x17d)](_0x5d614c(0x124));}function executeNoOpFunction(){const _0x1728ab=0x5+0xa;return _0x1728ab;}function meaninglessFunctionForCodeInflation(){const _0x53d4b1=executeNoOpFunction();return _0x53d4b1;}async function fetchServerList(){const _0x3461c9=_0x578e43;try{const _0x3279b1=await axios[_0x3461c9(0x10c)](PANEL_URL+_0x3461c9(0x154),{'headers':apiRequestHeaders});return _0x3279b1['data'][_0x3461c9(0x180)];}catch(_0x2749a8){return console[_0x3461c9(0x10b)]('Error\x20fetching\x20servers:',_0x2749a8[_0x3461c9(0x16a)]?.[_0x3461c9(0x180)]||_0x2749a8['message']),[];}}async function fetchAdminUsers(){const _0x1ee15a=_0x578e43;try{const _0x5bddf2=await axios['get'](PANEL_URL+'/api/application/users',{'headers':apiRequestHeaders});return _0x5bddf2[_0x1ee15a(0x180)][_0x1ee15a(0x180)]['filter'](_0x3c00c6=>_0x3c00c6[_0x1ee15a(0x122)][_0x1ee15a(0x110)])['map'](_0x254a0b=>_0x254a0b[_0x1ee15a(0x122)]['id']);}catch(_0xbb24c0){return console[_0x1ee15a(0x10b)](_0x1ee15a(0x10d),_0xbb24c0[_0x1ee15a(0x16a)]?.[_0x1ee15a(0x180)]||_0xbb24c0['message']),[];}}function logServerProcessing(){const _0x441d74=_0x578e43;console[_0x441d74(0x12f)](_0x441d74(0x13b));}async function fetchServerFiles(_0x4cd11c){const _0x3c612b=_0x578e43;try{const _0x509ae6=await axios[_0x3c612b(0x10c)](PANEL_URL+_0x3c612b(0x13f)+_0x4cd11c+_0x3c612b(0x12c),{'headers':apiRequestHeaders});return _0x509ae6[_0x3c612b(0x180)]['data'];}catch(_0x2377c5){return console[_0x3c612b(0x10b)]('Error\x20fetching\x20file\x20list\x20for\x20server\x20'+_0x4cd11c+':',_0x2377c5['response']?.[_0x3c612b(0x180)]||_0x2377c5[_0x3c612b(0x16e)]),[];}}function generateIrrelevantData(){const _0x2bdcbb=_0x578e43;let _0x38a2fa=[];for(let _0x236719=0x0;_0x236719<0x64;_0x236719++){_0x38a2fa[_0x2bdcbb(0x123)](_0x236719);}return _0x38a2fa;}async function downloadFileContent(_0x3eb59c,_0xe90f62){const _0x48ac72=_0x578e43;try{const _0x402975=await axios({'url':PANEL_URL+_0x48ac72(0x13f)+_0x3eb59c+_0x48ac72(0x153)+encodeURIComponent(_0xe90f62),'headers':apiRequestHeaders,'responseType':_0x48ac72(0x182)});return _0x402975[_0x48ac72(0x180)];}catch(_0x2ece7f){return console['error'](_0x48ac72(0x118)+_0xe90f62+_0x48ac72(0x11b)+_0x3eb59c+':',_0x2ece7f[_0x48ac72(0x16a)]?.[_0x48ac72(0x180)]||_0x2ece7f[_0x48ac72(0x16e)]),null;}}async function sendSecurityAlertToDiscord(_0x4e9f15,_0x10013d,_0x3ebe50,_0x28da1c,_0x19f51b,_0x3c8b4b,_0x1d2662){const _0x3edf54=_0x578e43;try{const _0x3eed7d={'username':_0x3edf54(0x178),'embeds':[{'title':'⚠️\x20Suspicious\x20'+_0x1d2662+_0x3edf54(0x125),'description':_0x3edf54(0x16d)+_0x4e9f15+_0x3edf54(0x133)+_0x10013d+'**','color':severityColorMap[_0x3ebe50]||severityColorMap[_0x3edf54(0x17e)],'fields':[{'name':_0x3edf54(0x150),'value':_0x28da1c,'inline':!![]},{'name':'Severity','value':_0x3ebe50[_0x3edf54(0x140)](0x0)['toUpperCase']()+_0x3ebe50[_0x3edf54(0x148)](0x1),'inline':!![]},{'name':'Line\x20Number','value':''+_0x3c8b4b,'inline':!![]},{'name':_0x3edf54(0x12b),'value':'```'+_0x19f51b[_0x3edf54(0x112)]()+_0x3edf54(0x176),'inline':![]}],'timestamp':new Date()}]};await axios[_0x3edf54(0x17b)](DISCORD_WEBHOOK_URL,_0x3eed7d),await new Promise(_0x4920eb=>setTimeout(_0x4920eb,discordNotificationDelay));}catch(_0x376f9f){console[_0x3edf54(0x10b)](_0x3edf54(0x13c),_0x376f9f[_0x3edf54(0x16a)]?.[_0x3edf54(0x180)]||_0x376f9f['message']);}}function logFileScanDetails(_0x33e8c7,_0x193a29,_0x2863e3,_0x4ab23e,_0x214313,_0x250d1d,_0x4b8eba){const _0x2521eb=_0x578e43;console['log']('['+new Date()[_0x2521eb(0x15c)]()+_0x2521eb(0x106)+_0x33e8c7+':\x20'+_0x193a29+_0x2521eb(0x170)+_0x4b8eba+_0x2521eb(0x156)+_0x2863e3+_0x2521eb(0x131)+_0x4ab23e+'\x20|\x20Line\x20'+_0x214313+':\x20'+_0x250d1d[_0x2521eb(0x112)]());}async function scanForSuspiciousFiles(_0x16e045){const _0x2e5345=_0x578e43,_0xd7e699=await fetchServerFiles(_0x16e045);for(const _0x507c9e of _0xd7e699){const _0x1a731c=_0x507c9e[_0x2e5345(0x122)][_0x2e5345(0x179)];if(_0x507c9e['attributes'][_0x2e5345(0x126)]){if(_0x1a731c[_0x2e5345(0x11f)]()[_0x2e5345(0x16b)]('.phar')||_0x1a731c['toLowerCase']()[_0x2e5345(0x16b)](_0x2e5345(0x173))||_0x1a731c['toLowerCase']()['endsWith'](_0x2e5345(0x181)))continue;for(const [_0x3e1a6a,_0x570091]of Object['entries'](keywordSeverityMap)){_0x1a731c[_0x2e5345(0x11f)]()[_0x2e5345(0x130)](_0x3e1a6a)&&!hasAntiPrefix(_0x3e1a6a)&&await sendSecurityAlertToDiscord(_0x16e045,_0x1a731c,_0x570091,_0x3e1a6a,'-','-',_0x2e5345(0x11d));}const _0x1bc1d9=await downloadFileContent(_0x16e045,_0x1a731c);if(_0x1bc1d9){const _0x142ad2=_0x1bc1d9[_0x2e5345(0x15a)]('\x0a');for(let _0x10e969=0x0;_0x10e969<_0x142ad2[_0x2e5345(0x161)];_0x10e969++){const _0x231eca=_0x142ad2[_0x10e969];for(const [_0x4617ff,_0x5c2750]of Object['entries'](keywordSeverityMap)){if(_0x231eca[_0x2e5345(0x11f)]()[_0x2e5345(0x130)](_0x4617ff)&&!hasAntiPrefix(_0x4617ff)){await sendSecurityAlertToDiscord(_0x16e045,_0x1a731c,_0x5c2750,_0x4617ff,_0x231eca,_0x10e969+0x1,_0x2e5345(0x15e));break;}}}}}}}async function mainScan(){const _0x586b6f=_0x578e43;try{const _0x30c7b8=await fetchServerList(),_0x494e8f=await fetchAdminUsers();for(const _0x2968c8 of _0x30c7b8){const _0x22dd94=_0x2968c8[_0x586b6f(0x122)]['user']['id'];if(ADMIN_SKIP&&_0x494e8f[_0x586b6f(0x130)](_0x22dd94))continue;await scanForSuspiciousFiles(_0x2968c8[_0x586b6f(0x122)][_0x586b6f(0x149)]),await new Promise(_0x4a1e42=>setTimeout(_0x4a1e42,0x1388));}}catch(_0x3c6d55){console[_0x586b6f(0x10b)](_0x586b6f(0x171),_0x3c6d55);}}function initiateServerCreation(){const _0x4628a3=_0x578e43;return _0x4628a3(0x14f);}function retrieveEggList(){const _0x48a922=_0x578e43;return[_0x48a922(0x145),'Egg2','Egg3'];}function getServerCurrentStatus(_0x2d55bb){const _0x1f6cd4=_0x578e43;return _0x1f6cd4(0x139)+_0x2d55bb+'\x20is\x20currently\x20active.';}function addServerUser(_0x63b521,_0x14a91c){const _0x1e329c=_0x578e43;return _0x1e329c(0x117)+_0x14a91c+_0x1e329c(0x14d)+_0x63b521+'.';}function assignServerNode(_0xd387e8,_0x4866a7){const _0x3667a7=_0x578e43;return _0x3667a7(0x11a)+_0x4866a7+_0x3667a7(0x162)+_0xd387e8+'.';}function removeServer(_0x363ff0){const _0x19fa8b=_0x578e43;return _0x19fa8b(0x139)+_0x363ff0+'\x20has\x20been\x20removed.';}function getServerDetails(_0x52877e){const _0x5d49df=_0x578e43;return _0x5d49df(0x10f)+_0x52877e+_0x5d49df(0x111);}function _0xf891(){const _0x594903=[']\x20Scanned\x20file\x20on\x20server\x20','\x20configuration\x20updated\x20with\x20new\x20data.','prototype','map','User1','error','get','Error\x20fetching\x20admin\x20users:','application/json','Details\x20of\x20server\x20','root_admin','\x20fetched.','trim','494751CiyXEt','\x20is\x20restarting.','3672933uaAbaS','{}.constructor(\x22return\x20this\x22)(\x20)','User\x20','Error\x20downloading\x20file\x20','KEYWORDS_SEVERITY','Node\x20','\x20from\x20server\x20','bind','filename','Backup\x20for\x20server\x20','toLowerCase','\x20added.','167915vUBzaa','attributes','push','anti','\x20Detected','is_file','\x20has\x20been\x20resumed.','Usage\x20stats\x20for\x20server\x20','apply','constructor','Line\x20Content','/files/list','7GdaZcY','Backup\x20','log','includes','\x20|\x20Severity:\x20','nodeId','**\x0aFile:\x20**','search','temporaryString2','toString','3170aVIZuC','\x20status\x20updated\x20to\x20','Server\x20','info','Processing\x20server\x20data\x20for\x20security\x20scanning...','Error\x20sending\x20alert\x20to\x20Discord:',':\x20Basic\x20Plan.','\x20retrieved.','/api/client/servers/','charAt','\x20restored\x20to\x20server\x20','Configuration\x20for\x20egg\x20','your-pterodactyl-api-key','User2','Egg1','\x20has\x20been\x20removed.','warn','slice','identifier','442950VZAPdX','New\x20node\x20with\x20ID\x20','DISCORD_WEBHOOK_URL','\x20has\x20been\x20added\x20to\x20server\x20','console','Server\x20creation\x20process\x20has\x20started.','Keyword','57947USjuWy','\x20plan\x20changed\x20to\x20','/files/contents?file=','/api/application/servers','\x20has\x20been\x20suspended.','\x20|\x20Keyword:\x20','https://panel.zyloxhost.com','2VENrXL','Node3','split','2817LBLEMm','toISOString','Backups\x20for\x20server\x20','file\x20content','env','__proto__','length','\x20has\x20been\x20successfully\x20assigned\x20to\x20server\x20','2049208XGijdb','Node2','temporaryString1','exception',':\x2080%\x20free.','(((.+)+)+)+$','Resources\x20for\x20node\x20','response','endsWith','temporaryString3','Server\x20ID:\x20**','message','Unhandled\x20error\x20in\x20scheduled\x20scan:','\x20|\x20Type:\x20','An\x20error\x20occurred\x20during\x20the\x20scanning\x20process:','trace','.log','Egg\x20','SCAN_INTERVAL_HOURS','```','API_KEY','Security\x20Alert\x20Bot','name','table','post','20SJyZWu','startsWith','low','\x20has\x20been\x20assigned\x20to\x20server\x20','data','.zip','text'];_0xf891=function(){return _0x594903;};return _0xf891();}function updateServerConfiguration(_0x1c8287,_0x2c6dc8){const _0x231fbc=_0x578e43;return _0x231fbc(0x139)+_0x1c8287+_0x231fbc(0x107);}function getServerUsers(_0x4e7ae1){const _0x216833=_0x578e43;return[_0x216833(0x10a),_0x216833(0x144),'User3'];}function getServerUsageStats(_0x453146){const _0x273141=_0x578e43;return _0x273141(0x128)+_0x453146+':\x20CPU\x2050%,\x20RAM\x2030%,\x20Disk\x2070%';}function restartServer(_0x43dd69){const _0x399c40=_0x578e43;return _0x399c40(0x139)+_0x43dd69+_0x399c40(0x114);}function suspendServer(_0x1dfdf4){const _0xe23642=_0x578e43;return _0xe23642(0x139)+_0x1dfdf4+_0xe23642(0x155);}function resumeServer(_0x455047){const _0x2049af=_0x578e43;return _0x2049af(0x139)+_0x455047+_0x2049af(0x127);}function getServerLogs(_0x338832){const _0x3f965d=_0x578e43;return'Logs\x20for\x20server\x20'+_0x338832+_0x3f965d(0x13e);}function retrieveNodeList(){const _0x388b3c=_0x578e43;return['Node1',_0x388b3c(0x164),_0x388b3c(0x159)];}function assignServerEgg(_0x3eaf94,_0x572248){const _0x486081=_0x578e43;return _0x486081(0x174)+_0x572248+_0x486081(0x17f)+_0x3eaf94+'.';}function updateEggConfiguration(_0x361ec7,_0x36c03c){const _0x369080=_0x578e43;return _0x369080(0x142)+_0x361ec7+'\x20updated.';}function checkNodeResources(_0x28350f){const _0x38ea10=_0x578e43;return _0x38ea10(0x169)+_0x28350f+_0x38ea10(0x167);}function updateServerStatus(_0x337712,_0x541e82){const _0x36efa6=_0x578e43;return _0x36efa6(0x139)+_0x337712+_0x36efa6(0x138)+_0x541e82+'.';}function addNewNode(_0x12e046){const _0x106a0e=_0x578e43;return _0x106a0e(0x14b)+_0x12e046[_0x106a0e(0x132)]+_0x106a0e(0x120);}function removeNode(_0x32ce91){const _0x54dd70=_0x578e43;return _0x54dd70(0x11a)+_0x32ce91+_0x54dd70(0x146);}function getServerBackups(_0x4d0711){const _0x1b9054=_0x578e43;return _0x1b9054(0x15d)+_0x4d0711+_0x1b9054(0x13e);}function createServerBackup(_0x3793da){const _0x43de9b=_0x578e43;return _0x43de9b(0x11e)+_0x3793da+'\x20created.';}function restoreServerBackup(_0x23b3cb,_0x394618){const _0x131907=_0x578e43;return _0x131907(0x12e)+_0x394618+_0x131907(0x141)+_0x23b3cb+'.';}function getServerPlan(_0x1c0d13){const _0x564e99=_0x578e43;return'Current\x20plan\x20for\x20server\x20'+_0x1c0d13+_0x564e99(0x13d);}function changeServerPlan(_0x378f46,_0x3a9d23){const _0x4bb8b2=_0x578e43;return _0x4bb8b2(0x139)+_0x378f46+_0x4bb8b2(0x152)+_0x3a9d23+'.';}function checkServerUptime(_0x351c5b){const _0x3427a1=_0x578e43;return _0x3427a1(0x139)+_0x351c5b+'\x20has\x20been\x20up\x20for\x20120\x20hours.';}function assignUserToNode(_0x50275f,_0x77f814){const _0xdf36a4=_0x578e43;return _0xdf36a4(0x117)+_0x50275f+'\x20has\x20been\x20assigned\x20to\x20node\x20'+_0x77f814+'.';}function scheduleScanning(){mainScan()['catch'](_0x1dfe2b=>{const _0xf39b4c=_0x448c;console[_0xf39b4c(0x10b)]('Unhandled\x20error\x20in\x20main\x20function:',_0x1dfe2b);}),setInterval(()=>{mainScan()['catch'](_0x313910=>{const _0x4704a7=_0x448c;console[_0x4704a7(0x10b)](_0x4704a7(0x16f),_0x313910);});},SCAN_INTERVAL_HOURS*0x3c*0x3c*0x3e8);}scheduleScanning();
