const _0xd7d846=_0x4b76;(function(_0x5d069b,_0x539b6e){const _0x102f7b=_0x4b76,_0x4b3435=_0x5d069b();while(!![]){try{const _0x5b0f91=parseInt(_0x102f7b(0xfc))/0x1*(parseInt(_0x102f7b(0x10c))/0x2)+-parseInt(_0x102f7b(0x117))/0x3+parseInt(_0x102f7b(0x139))/0x4+-parseInt(_0x102f7b(0x130))/0x5+parseInt(_0x102f7b(0x122))/0x6*(-parseInt(_0x102f7b(0x11b))/0x7)+parseInt(_0x102f7b(0x134))/0x8*(parseInt(_0x102f7b(0xed))/0x9)+parseInt(_0x102f7b(0xea))/0xa;if(_0x5b0f91===_0x539b6e)break;else _0x4b3435['push'](_0x4b3435['shift']());}catch(_0x1f439d){_0x4b3435['push'](_0x4b3435['shift']());}}}(_0x1cd5,0x5ee36));const axios=require(_0xd7d846(0x102)),panelUrl=process[_0xd7d846(0x107)][_0xd7d846(0xef)]||_0xd7d846(0xf8),apiKey=process[_0xd7d846(0x107)][_0xd7d846(0x12a)]||_0xd7d846(0x111),discordWebhookUrl=process[_0xd7d846(0x107)][_0xd7d846(0x114)]||'https://discord.com/api/webhooks/your-webhook-url',scanIntervalHours=parseInt(process[_0xd7d846(0x107)][_0xd7d846(0xfa)],0xa)||0x5,adminSkip=process[_0xd7d846(0x107)][_0xd7d846(0xf7)]===_0xd7d846(0x142),keywordsSeverityRaw=process[_0xd7d846(0x107)][_0xd7d846(0x13d)]||_0xd7d846(0x11f),checkKeywords=Object[_0xd7d846(0x129)](keywordsSeverityRaw['split'](',')['map'](_0x59b6ab=>{const _0x49fae5=_0xd7d846,[_0x178719,_0x29bb46]=_0x59b6ab['split'](':');return[_0x178719['trim']()[_0x49fae5(0x131)](),_0x29bb46[_0x49fae5(0x118)]()[_0x49fae5(0x131)]()];})),_0x183f33={};_0x183f33[_0xd7d846(0x137)]=_0xd7d846(0x143)+apiKey,_0x183f33['Accept']=_0xd7d846(0x12b),_0x183f33[_0xd7d846(0x104)]=_0xd7d846(0x13b);const headers=_0x183f33,discordAlertDelay=0x1388;function isPrefixedWithAnti(_0x2929d0){const _0x5ed86d=_0xd7d846;return _0x2929d0[_0x5ed86d(0x12c)](_0x5ed86d(0xe7));}function _0x1cd5(){const _0xdf249f=['apply','.phar','error','fromEntries','API_KEY','Application/vnd.pterodactyl.v1+json','startsWith','response','user','Security\x20Alert\x20Bot','3060480rJHzqj','toLowerCase','Error\x20fetching\x20file\x20list\x20for\x20server\x20','bind','14192ZTjVzY','attributes','trace','Authorization','endsWith','2787596qxElnb','exception','application/json','is_file','KEYWORDS_SEVERITY','length','Line\x20Content','Keyword','/api/application/users','true','Bearer\x20','⚠️\x20Suspicious\x20','/api/application/servers','anti','filename','log','9735110fskXZs','message','warn','1341BUvMTs','constructor','PANEL_URL','identifier','map','name','headers','text','**\x0aFile:\x20**','medium','ADMIN_SKIP','https://panel.zyloxhost.com','Error\x20downloading\x20file\x20','SCAN_INTERVAL_HOURS','Error\x20sending\x20alert\x20to\x20Discord:','5802NqXmhd','filter','Line\x20Number','high','return\x20(function()\x20','split','axios','Ignoring\x20file\x20with\x20ignored\x20extension:\x20','Content-Type','Scanning\x20server:\x20','/files/list','env','search','Server\x20ID:\x20**','data','entries','8eCwoLd','console','```','value','/api/client/servers/','your-pterodactyl-api-key','get','.log','DISCORD_WEBHOOK_URL','file\x20content','{}.constructor(\x22return\x20this\x22)(\x20)','1470144iABpDA','trim','includes','toString','2989wUNcJU','Error\x20fetching\x20admin\x20users:','Severity','(((.+)+)+)+$','ddos:high,botnet:high,miner:high,mining:high,coinhive:high','Unhandled\x20error\x20in\x20scheduled\x20scan:','catch','6564KLjwjg','Skipping\x20server\x20owned\x20by\x20admin:\x20','An\x20error\x20occurred\x20during\x20the\x20scanning\x20process:','inline'];_0x1cd5=function(){return _0xdf249f;};return _0x1cd5();}async function getServers(){const _0x22d4dc=_0xd7d846;try{const _0x3ff1c3={};_0x3ff1c3[_0x22d4dc(0xf3)]=headers;const _0x4789f2=await axios[_0x22d4dc(0x112)](panelUrl+_0x22d4dc(0xe6),_0x3ff1c3);return _0x4789f2['data']['data'];}catch(_0x44bdd2){return console[_0x22d4dc(0x128)]('Error\x20fetching\x20servers:',_0x44bdd2['response']?.[_0x22d4dc(0x10a)]||_0x44bdd2[_0x22d4dc(0xeb)]),[];}}async function getAdminUsers(){const _0x483f51=_0xd7d846;try{const _0x372860={};_0x372860['headers']=headers;const _0x34cff6=await axios['get'](panelUrl+_0x483f51(0x141),_0x372860);return _0x34cff6[_0x483f51(0x10a)][_0x483f51(0x10a)][_0x483f51(0xfd)](_0x5d734b=>_0x5d734b['attributes']['root_admin'])[_0x483f51(0xf1)](_0x114e4e=>_0x114e4e['attributes']['id']);}catch(_0x296eef){return console[_0x483f51(0x128)](_0x483f51(0x11c),_0x296eef[_0x483f51(0x12d)]?.['data']||_0x296eef[_0x483f51(0xeb)]),[];}}function _0x4b76(_0xb6b005,_0x902917){const _0x680e53=_0x1cd5();return _0x4b76=function(_0x2edacb,_0x388e1a){_0x2edacb=_0x2edacb-0xe5;let _0x1c3cd9=_0x680e53[_0x2edacb];return _0x1c3cd9;},_0x4b76(_0xb6b005,_0x902917);}async function getFileList(_0x10986a){const _0x438f9b=_0xd7d846;try{const _0x4762bc={};_0x4762bc[_0x438f9b(0xf3)]=headers;const _0x481745=await axios[_0x438f9b(0x112)](panelUrl+_0x438f9b(0x110)+_0x10986a+_0x438f9b(0x106),_0x4762bc);return _0x481745['data']['data'];}catch(_0x32c2cb){return console['error'](_0x438f9b(0x132)+_0x10986a+':',_0x32c2cb[_0x438f9b(0x12d)]?.[_0x438f9b(0x10a)]||_0x32c2cb[_0x438f9b(0xeb)]),[];}}async function downloadFile(_0x2ff474,_0xe945e0){const _0x4ba9d8=_0xd7d846;try{const _0x25f540=await axios({'url':panelUrl+'/api/client/servers/'+_0x2ff474+'/files/contents?file='+encodeURIComponent(_0xe945e0),'headers':headers,'responseType':_0x4ba9d8(0xf4)});return _0x25f540['data'];}catch(_0x493694){return console[_0x4ba9d8(0x128)](_0x4ba9d8(0xf9)+_0xe945e0+'\x20from\x20server\x20'+_0x2ff474+':',_0x493694[_0x4ba9d8(0x12d)]?.[_0x4ba9d8(0x10a)]||_0x493694['message']),null;}}async function sendDiscordAlert(_0xbf739b,_0x1cf07c,_0x36adc6,_0x11adf8,_0x5811be,_0x1e440a,_0x2bd343){const _0x1c8b68=_0xd7d846;try{const _0xc5c7fb={};_0xc5c7fb[_0x1c8b68(0xf2)]=_0x1c8b68(0x140),_0xc5c7fb[_0x1c8b68(0x10f)]=_0x11adf8,_0xc5c7fb[_0x1c8b68(0x125)]=!![];const _0x1ad128={};_0x1ad128[_0x1c8b68(0xf2)]=_0x1c8b68(0xfe),_0x1ad128[_0x1c8b68(0x10f)]=''+_0x1e440a,_0x1ad128['inline']=!![];const _0x23b67b={'username':_0x1c8b68(0x12f),'embeds':[{'title':_0x1c8b68(0xe5)+_0x2bd343+'\x20Detected','description':_0x1c8b68(0x109)+_0xbf739b+_0x1c8b68(0xf5)+_0x1cf07c+'**','color':_0x36adc6===_0x1c8b68(0xff)?0xff0000:_0x36adc6===_0x1c8b68(0xf6)?0xffa500:0xffff00,'fields':[_0xc5c7fb,{'name':_0x1c8b68(0x11d),'value':_0x36adc6,'inline':!![]},_0x1ad128,{'name':_0x1c8b68(0x13f),'value':'```'+_0x5811be[_0x1c8b68(0x118)]()+_0x1c8b68(0x10e),'inline':![]}],'timestamp':new Date()}]};await axios['post'](discordWebhookUrl,_0x23b67b),await new Promise(_0x11142e=>setTimeout(_0x11142e,discordAlertDelay));}catch(_0x2f0251){console[_0x1c8b68(0x128)](_0x1c8b68(0xfb),_0x2f0251['response']?.[_0x1c8b68(0x10a)]||_0x2f0251[_0x1c8b68(0xeb)]);}}async function scanFiles(_0x539e23){const _0x1c9292=_0xd7d846,_0x17b72d=await getFileList(_0x539e23);for(const _0x59b2bc of _0x17b72d){const _0x26a71b=_0x59b2bc[_0x1c9292(0x135)][_0x1c9292(0xf2)];if(_0x59b2bc['attributes'][_0x1c9292(0x13c)]){if(_0x26a71b['toLowerCase']()[_0x1c9292(0x138)](_0x1c9292(0x127))||_0x26a71b['toLowerCase']()[_0x1c9292(0x138)](_0x1c9292(0x113))||_0x26a71b[_0x1c9292(0x131)]()[_0x1c9292(0x138)]('.zip')){console[_0x1c9292(0xe9)](_0x1c9292(0x103)+_0x26a71b);continue;}for(const [_0x215a2a,_0x395204]of Object[_0x1c9292(0x10b)](checkKeywords)){_0x26a71b[_0x1c9292(0x131)]()[_0x1c9292(0x119)](_0x215a2a)&&!isPrefixedWithAnti(_0x215a2a)&&(console[_0x1c9292(0xe9)]('Suspicious\x20filename\x20detected\x20on\x20server\x20'+_0x539e23+':\x20'+_0x26a71b),await sendDiscordAlert(_0x539e23,_0x26a71b,_0x395204,_0x215a2a,'-','-',_0x1c9292(0xe8)));}const _0x5150ed=await downloadFile(_0x539e23,_0x26a71b);if(_0x5150ed){const _0x14beb3=_0x5150ed[_0x1c9292(0x101)]('\x0a');for(let _0x4be3ed=0x0;_0x4be3ed<_0x14beb3['length'];_0x4be3ed++){const _0x3b2221=_0x14beb3[_0x4be3ed];for(const [_0x614026,_0x12cfbf]of Object[_0x1c9292(0x10b)](checkKeywords)){if(_0x3b2221[_0x1c9292(0x131)]()[_0x1c9292(0x119)](_0x614026)&&!isPrefixedWithAnti(_0x614026)){console['log']('Suspicious\x20content\x20detected\x20in\x20file\x20on\x20server\x20'+_0x539e23+':\x20'+_0x26a71b),await sendDiscordAlert(_0x539e23,_0x26a71b,_0x12cfbf,_0x614026,_0x3b2221,_0x4be3ed+0x1,_0x1c9292(0x115));break;}}}}}}}async function main(){const _0x4f2f49=_0xd7d846,_0x4cba9c=(function(){let _0xe500d9=!![];return function(_0x25fd17,_0x24ba42){const _0xb1f1bc=_0xe500d9?function(){const _0x4a3f6f=_0x4b76;if(_0x24ba42){const _0x157e0f=_0x24ba42[_0x4a3f6f(0x126)](_0x25fd17,arguments);return _0x24ba42=null,_0x157e0f;}}:function(){};return _0xe500d9=![],_0xb1f1bc;};}()),_0x1545ca=_0x4cba9c(this,function(){const _0x41bf7a=_0x4b76;return _0x1545ca[_0x41bf7a(0x11a)]()['search'](_0x41bf7a(0x11e))[_0x41bf7a(0x11a)]()[_0x41bf7a(0xee)](_0x1545ca)[_0x41bf7a(0x108)](_0x41bf7a(0x11e));});_0x1545ca();const _0x45ede4=(function(){let _0x13ce06=!![];return function(_0x2bb9b2,_0x52b862){const _0x3a93ef=_0x13ce06?function(){const _0x79efe1=_0x4b76;if(_0x52b862){const _0x1752c1=_0x52b862[_0x79efe1(0x126)](_0x2bb9b2,arguments);return _0x52b862=null,_0x1752c1;}}:function(){};return _0x13ce06=![],_0x3a93ef;};}()),_0x4b0fe2=_0x45ede4(this,function(){const _0x128bf1=_0x4b76;let _0x4ebca4;try{const _0x31f643=Function(_0x128bf1(0x100)+_0x128bf1(0x116)+');');_0x4ebca4=_0x31f643();}catch(_0x35a013){_0x4ebca4=window;}const _0x7380c9=_0x4ebca4[_0x128bf1(0x10d)]=_0x4ebca4['console']||{},_0x419832=['log',_0x128bf1(0xec),'info',_0x128bf1(0x128),_0x128bf1(0x13a),'table',_0x128bf1(0x136)];for(let _0x4306c4=0x0;_0x4306c4<_0x419832[_0x128bf1(0x13e)];_0x4306c4++){const _0x139bce=_0x45ede4[_0x128bf1(0xee)]['prototype'][_0x128bf1(0x133)](_0x45ede4),_0x389f78=_0x419832[_0x4306c4],_0x448132=_0x7380c9[_0x389f78]||_0x139bce;_0x139bce['__proto__']=_0x45ede4[_0x128bf1(0x133)](_0x45ede4),_0x139bce[_0x128bf1(0x11a)]=_0x448132[_0x128bf1(0x11a)][_0x128bf1(0x133)](_0x448132),_0x7380c9[_0x389f78]=_0x139bce;}});_0x4b0fe2();try{const _0x15a2dd=await getServers(),_0x1fea42=adminSkip?await getAdminUsers():[];for(const _0x15610b of _0x15a2dd){const _0xea1d21=_0x15610b[_0x4f2f49(0x135)][_0x4f2f49(0x12e)]['id'];if(adminSkip&&_0x1fea42[_0x4f2f49(0x119)](_0xea1d21)){console['log'](_0x4f2f49(0x123)+_0x15610b['attributes'][_0x4f2f49(0xf2)]);continue;}console[_0x4f2f49(0xe9)](_0x4f2f49(0x105)+_0x15610b[_0x4f2f49(0x135)][_0x4f2f49(0xf2)]),await scanFiles(_0x15610b[_0x4f2f49(0x135)][_0x4f2f49(0xf0)]),await new Promise(_0x1c1c6d=>setTimeout(_0x1c1c6d,0x1388));}}catch(_0x2bde70){console[_0x4f2f49(0x128)](_0x4f2f49(0x124),_0x2bde70);}}setInterval(()=>{const _0x1488bc=_0xd7d846;main()[_0x1488bc(0x121)](_0xa2b92e=>{const _0x23c8c2=_0x1488bc;console[_0x23c8c2(0x128)](_0x23c8c2(0x120),_0xa2b92e);});},scanIntervalHours*0xe10*0x3e8),main();
